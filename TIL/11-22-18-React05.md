# React

- UI를 `값`으로 다룬다. => props로 넘기기도하고, ...
- 뭔가 기억하고있다가 바꾸려면 상태를 써야해요!!!

---
## 합성 (composition) vs 상속 (inheritance)
- *FancyBorder* 태그 안의 요소들이 props.children이라는 이름의 props으로 넘어감
- Layout.js에 컴포넌트를 생성
  * Layout이라는 이름은 내가 마음대로 지정할 수 있음

## Context
- App의 여러군데에서(전역에서) 공유되어야 할 때
- 예를 들어 언어 설정, UI 테마 등
- 정보를 내려주고 싶은 영역을 Provider로 감싸줌
  ```js
  //Toolbar에서 dark정보를 내려받고 있지 않음!!!!!!
  <ThemeContext.Provider value="dark">
    <Toolbar />
  </ThemeContext.Provider>
  ```
- Consumer
  ```js
  //위에서 내려준 dark를 받아옴
  //계층이 깊어도 알아서 내려옴
  // 테마 context를 읽어오려면 Consumer를 사용하세요.
  // React는 가장 가까운 Provider를 찾아서 그 값을 사용할 것입니다.
  <ThemeContext.Consumer>
    {theme => <Button {...props} theme={theme} />} //내가 뭘 렌더링하고싶은지
  </ThemeContext.Consumer>
  ```           
- Context는 여러개 생성가능하지만, 연결되어 사용해야한다. 같은 context로부터 생성된 가장 가까운 상위 Provider에서 현재 context의 값을 읽어옴
  * 사용법이 provider / Consumer  
- Provider의 자손인 모든 Consumer는 Provider의 value prop이 바뀔 때마다 다시 렌더링됨
  * 같은 값이면 렌더링되지 않는다.  
  * shouldComponentUpdate, pureComponent같은 경우로, 영향을 받지 않는다 하더라도 provider가 바뀌면 다시 렌더링됨
- 그때그때 다른 값을 내려주고 싶을때, provider를 내려주고있는 Component에 상태를 두고 상태를 바꿔주기  
- 상태에 객체를 내려보내주는 함수를 기본값으로 설정해두는 방법도 있음
- setState는 비동기식으로 동작하기 떄문에 이전 상태를 변경하려면 함수를 넣어줘야함
- bind() 어떤 함수에 this를 고정시켜주는 메소드
- 객체를 만들어서 내려줌, consumer 새로 rendering은 값이 새로 들어왔을 때 참조가 다르기 때문에 항상 render()됨. 내용이 달라져도 참조가 달라지지 않게  해주는 것이 좋기 때문에 ( *성능때문에* )공식 문서에서는 state에 함수를 내려주는 거임
  * 실제로 consumer가 바꼈을 때만, 작동하는 코드 
> [this.props.children실습](https://codesandbox.io/s/4j4x874v2x)  
- 원래는 render()안에 함수를 넣어 사용했는데, 그러면 비효율적이기때문에 상태에 함수를 만들어서 내려준다 => 약간 복잡하지만, 계속 그렇게 사용해왔음
```js
// 진짜 정보를 받아오는것도 provider 안에
<UserConsumer>{({ username }) => <div>{username}</div>}</UserConsumer>
// UserProvider 안에 기억
// 서버에 /me => 내가 누군지 => 이 정보를 받아와서(get) 상태를 바꿔주자 => 그려주자
// 사용자정보를 받아올 때 : localstorage에 token이 있으면,
// 여태 로그인폼에 있던 코드를, Provider로 옮겨오자!
// 이 방법으로 header에 avartarURL이나, username을 받아올 수 있당
```
- 재접속했을때
- 내가 쓴 글만 수정할 수 있게
```js
<UserConsumer>
  {({ id }) => {
    if (this.state.userId === id) {
      return <button onClick={() => onEditPostFormPage(postId)}>EDIT</button>;
    }
  }}
</UserConsumer>
```        
- 함수호출할때, 
```js
onClick={logout}
onClick={()=>logout()}
```
- 로그아웃
  * App에서 로그아웃되면 로그인페이지 보이는 메소드 만들고 내려주기
- 로그인 했을때,
  * Provider에 기능을 구현함 => App에 `의존성`이 있다 => 의존성이 있는 컴포넌트가 반드시 아래에 있어야함 

---  
# memo
